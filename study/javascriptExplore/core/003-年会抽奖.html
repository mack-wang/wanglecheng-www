<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>年会抽奖</title>
</head>
<style>
    html{
        width: 100%;
        height: 100%;
    }
    body{
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        background: radial-gradient(circle,#febf40,#f90216);
    }
    #wrap{
        position: relative;
        width: 800px;
        height: 800px;
        border-radius: 20px;
        background: #f90216;
        margin: 30px auto;
    }
    #gift-id{
        float: left;
    }
    #gift-id>button{
        display: block;
        width: 200px;
        height: 80px;
        background: #febf40;
        border-radius:20px ;
        margin: 50px;
        border: none;
        box-shadow: 5px 5px 20px #b10331;
        color: #f90216;
        font-size: 20px;
        font-weight: bold;
    }
    #right{
        color: #febf40;
        float: right;
        margin: 50px;

    }
    #right>ul>li{

        list-style: none;
    }
    #start-btn{
        position: absolute;
        bottom:50px;
        left: 150px;
        opacity: 1;
        width: 200px;
        height: 80px;
        color: #f90216;
        font-size: 30px;
        font-weight: bold;
    }
    #finished-btn{
        position: absolute;
        bottom:50px;
        left: 450px;
        opacity: 1;
        width: 200px;
        height: 80px;
        color: #f90216;
        font-size: 30px;
        font-weight: bold;
    }
    #wrap>ul{
        margin: 0;
        padding: 20px;
    }
    #wrap>ul>li{
        display: inline-block;
        list-style: none;
        margin: 10px 0 0 10px;
        background: #f95727;
        color: #fee120;
        text-align: center;
    }

</style>
<body>
<div id="left">
    <div id="gift">

    </div>
    <div id="gift-id">
        <button  value="06238">500元奖品(6份)</button>
        <button  value="20134">300元奖品(20份）</button>
        <button  value="24110">200元奖品(24份)</button>
        <button  value="09200">阳光普照奖(9份)</button>
        <button  value="06238">阳光普照奖(6份)</button>
    </div>
</div>
<div id="right">
<header id="gift-name"></header>
    <ul id="ul2">
    </ul>
</div>
<div id="wrap">
    <ul id="ul1">
    </ul>

    <button onclick="start()" id="start-btn">开始抽奖</button>
    <button onclick="finished()" id="finished-btn">停止抽奖</button>
</div>

</body>
<script>
    var boxWidth;
    var nameList = ["王小花1","张大帅2","张小一3","李大二4","王小5","张大6","张小7","李大8","王小花9","张大帅10","张小一11","李大二12","王小13","张大14","张小15","李大16"];
    var leftList = nameList;
    var randomNumArr = [];
    var id;
    var time;
    var giftId = document.getElementById("gift-id");
    var ul1 = document.getElementById("ul1");
    var ul2 = document.getElementById("ul2");
    var startBtn = document.getElementById("start-btn");
    var finishedBtn = document.getElementById("finished-btn");
    var giftName = document.getElementById("gift-name");
    var timeControl = false;

    giftId.addEventListener("click",function (event) {
        target=event.target;
        id=target.value.substr(0,2);
        boxWidth=parseInt(target.value.substr(2,5));
        randomMaker();
        draw();
    });

    function start() {
        time = setInterval(function () {
            randomMaker();
            draw();
        },100);
    }

    function finished() {
        var randomList = [];
        clearInterval(time);
        ul2.innerHTML="";
        giftName.innerHTML=target.innerHTML;
        for (var i=0;i<id;i++){
            var li = document.createElement("li");
            var name = leftList[randomNumArr[i]];
            li.innerHTML=name;
            randomList.push(name);
            ul2.appendChild(li);
        }
        leftList=leftList.minus(randomList);
        console.log(leftList);
    }


    function randomMaker(){
        randomNumArr = [];
        var num = leftList.length;
        for (;randomNumArr.length<id;){
            var rand = Math.floor(Math.random()*num);
            for(var j=0;j<randomNumArr.length;j++){
                if(randomNumArr[j]==rand){
                    rand = "";
                }
            }
            if(rand=="") continue;
            randomNumArr.push(rand);
        }
        return randomNumArr;
    }

    function draw() {
        ul1.innerHTML="";
        for (var i=0;i<id;i++){
            var li = document.createElement("li");
            li.innerHTML=leftList[randomNumArr[i]];
            li.style.width=boxWidth+"px";
            li.style.height=boxWidth+"px";
            li.style.lineHeight=boxWidth+"px";
            ul1.appendChild(li);
        }
    }

    ///集合取交集
    Array.intersect = function () {
        var result = new Array();
        var obj = {};
        for (var i = 0; i < arguments.length; i++) {
            for (var j = 0; j < arguments[i].length; j++) {
                var str = arguments[i][j];
                if (!obj[str]) {
                    obj[str] = 1;
                }
                else {
                    obj[str]++;
                    if (obj[str] == arguments.length)
                    {
                        result.push(str);
                    }
                }//end else
            }//end for j
        }//end for i
        return result;
    };

    //集合去掉重复
    Array.prototype.uniquelize = function () {
        var tmp = {},
                ret = [];
        for (var i = 0, j = this.length; i < j; i++) {
            if (!tmp[this[i]]) {
                tmp[this[i]] = 1;
                ret.push(this[i]);
            }
        }

        return ret;
    };
    //并集
    Array.union = function () {
        var arr = new Array();
        var obj = {};
        for (var i = 0; i < arguments.length; i++) {
            for (var j = 0; j < arguments[i].length; j++)
            {
                var str=arguments[i][j];
                if (!obj[str])
                {
                    obj[str] = 1;
                    arr.push(str);
                }
            }//end for j
        }//end for i
        return arr;
    };

    //2个集合的差集 在arr不存在
    Array.prototype.minus = function (arr) {
        var result = new Array();
        var obj = {};
        for (var i = 0; i < arr.length; i++) {
            obj[arr[i]] = 1;
        }
        for (var j = 0; j < this.length; j++) {
            if (!obj[this[j]])
            {
                obj[this[j]] = 1;
                result.push(this[j]);
            }
        }
        return result;
    };

    /*
     console.log(Array.intersect(["1", "2", "3"], ["2", "3", "4", "5", "6"]));//[2,3]
     console.log([1, 2, 3, 2, 3, 4, 5, 6].uniquelize());//[1,2,3,4,5,6]
     console.log(Array.union(["1", "2", "3"], ["2", "3", "4", "5", "6"], ["5", "6", "7", "8", "9"]))
     console.log(["2", "3", "4", "5", "6"].minus(["1", "2", "3"]));
    */


</script>
</html>